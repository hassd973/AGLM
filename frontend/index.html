<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A GRIEF LIKE MINE — Brand Kit (2025)</title>

<!-- Fonts: Modak + Sora sitewide. Sixtyfour is loaded but used ONLY for color names in the swatches. -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Modak&family=Sora:wght@300..800&family=Sixtyfour&display=swap" rel="stylesheet">

<style>
:root{
  /* ORIGINAL BRAND PALETTE (restored exactly) */
  --bg:#f7f6f3;          /* porcelain paper */
  /* Main logo colors */
  --blue1:#2c6fb1;       /* primary blue */
  --blue2:#6fb1ff;       /* sky */
  --blue3:#1d3f73;       /* deep blue */
  --sunset:#de9146;      /* sunset orange */
  --ink:#111111;         /* near-black */
  /* Extended blues */
  --blueA:#294b81;       /* extended */
  --blueB:#6b89bd;
  --blueC:#335694;
  /* Neutrals */
  --neutral1:#efe5d7;    /* oat */
  --neutral2:#ebe9d5;    /* bone */
  --neutral3:#f3f0ec;    /* porcelain */
  --rose:#dbb5c2;        /* accent */

  /* UI */
  --card:#ffffff;
  --muted:#4f5560;
  --shadow: 0 10px 30px rgba(0,0,0,.08);

  /* Derived tokens for components */
  --primary: var(--blue1);
  --primaryHover: color-mix(in srgb, var(--blue1) 80%, var(--blue2));
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family:'Sora', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  line-height:1.45;
}
img{max-width:100%;height:auto}

.container{max-width:1200px; margin:0 auto; padding:28px 20px 80px}
.header{
  display:flex; align-items:center; justify-content:space-between;
  gap:20px; padding:16px 0; position:sticky; top:0; background:linear-gradient(180deg, var(--bg), color-mix(in oklab, var(--bg) 85%, transparent));
  backdrop-filter: blur(6px);
  z-index:5;
}
.brand{ display:flex; align-items:center; gap:14px; }
.brand .dot{
  width:14px; height:14px; border-radius:50%; background:var(--blue1);
  box-shadow:0 0 0 6px color-mix(in srgb, var(--blue1) 12%, transparent);
}
/* Title readability (no condensation) */
.brand h1{ font-weight:400; font-size:48px; margin:0; letter-spacing:.01em; line-height:1.2 }
.brand h1 .modak{font-family:'Modak', cursive;}
.brand h1 .sora{font-family:'Sora', sans-serif;}
@media(max-width:700px){ .brand h1{ font-size:32px } }

.header nav{display:flex; gap:14px; flex-wrap:wrap}
.header a{ text-decoration:none; color:var(--ink); font-size:14px; opacity:.85; padding:6px 10px; border-radius:8px; }
.header a:hover{ background:color-mix(in srgb, var(--blue2) 18%, transparent); }

.grid{display:grid; grid-template-columns:repeat(12,1fr); gap:20px}
@media(max-width:700px){
  .grid{grid-template-columns:1fr}
  .grid .card{grid-column:span 12 !important}
}
.card{ background:var(--card); border-radius:18px; padding:18px; box-shadow:var(--shadow); }

/* Hero */
.hero{ position:relative; border-radius:22px; padding:28px; overflow:hidden; background:var(--card); box-shadow:var(--shadow) }
.hero h2{ font-family:'Modak', cursive; margin:0 0 10px; font-size:28px; letter-spacing:.01em }
.hero p{ margin:0; color:var(--muted) }

/* Floating sprites — idle only */
.particles{ position:absolute; inset:0; pointer-events:none; z-index:2 }
.sprite{ position:absolute; width:clamp(24px,2.6vw,34px); transform-origin:50% 60%;
         opacity:.95; filter:drop-shadow(0 2px 2px rgba(0,0,0,.12)); animation:floatY var(--dur,6s) ease-in-out infinite }
.sprite svg{ display:block; width:100%; height:auto }
.sprite .wing{ animation:flap var(--flap,1200ms) ease-in-out infinite; }
@keyframes flap{ 0%,100%{ transform:rotate(0) } 50%{ transform:rotate(var(--arc,14deg)) } }
@keyframes floatY{ 0%,100%{ transform:translateY(-6px) rotate(var(--start,0deg)) } 50%{ transform:translateY(6px) rotate(var(--end,-2deg)) } }

/* Global flock sprites */
.flock-layer{position:fixed;inset:0;pointer-events:none;z-index:1000}
.flock{position:absolute;width:clamp(18px,2vw,28px);opacity:0;transform-origin:50% 70%;filter:drop-shadow(0 1px 0 rgba(0,0,0,.12));}
.flock svg{display:block;width:100%;height:auto}
.flock .wing{animation:flap var(--flap,460ms) ease-in-out infinite}
.flock.fly{animation:flight var(--dur,2800ms) cubic-bezier(.2,.6,.1,1) forwards}
@keyframes flight{
 0%{opacity:0;transform:translate(var(--x,0),var(--y,0)) rotate(var(--r0,0deg)) scale(var(--s,1))}
 8%{opacity:1}
 100%{opacity:0;transform:translate(calc(var(--x) + var(--dx,0)), calc(var(--y) + var(--dy,0))) rotate(var(--r1,-20deg)) scale(calc(var(--s,1)*.8))}
}

/* Logo stage */
.stage{ position:relative; display:grid; place-items:center; aspect-ratio:1/1; background:var(--neutral3); border-radius:20px; overflow:hidden; }
.stage .overlay-note{ position:absolute; bottom:10px; right:10px; font-size:12px; background:rgba(255,255,255,.8); padding:6px 10px; border-radius:10px; color:#333; box-shadow:0 6px 20px rgba(0,0,0,.08); }
.stage img{width:80%;height:auto}
.fullscreen-link{position:absolute;top:10px;right:10px;width:24px;height:24px;border-radius:50%;background:rgba(255,255,255,.8);display:flex;align-items:center;justify-content:center;text-decoration:none;color:#333;box-shadow:0 2px 6px rgba(0,0,0,.2)}
.fullscreen-link::before{content:'↗';font-size:14px}

.actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top:14px }
button, .btn{
  appearance:none; border:0; border-radius:12px; padding:10px 14px; font-weight:700; cursor:pointer; background:var(--primary); color:white;
  box-shadow:0 6px 16px rgba(44,111,177,.25);
}
button:hover{ background:var(--primaryHover) }
button.secondary{ background:#fff; color:var(--ink); border:1px solid color-mix(in srgb, var(--ink) 12%, transparent) }
.btn:focus, button:focus{ outline:2px solid color-mix(in srgb, var(--blue2) 40%, transparent) }

/* Color swatches */
.swatches{ display:grid; grid-template-columns:repeat(auto-fit, minmax(160px,1fr)); gap:14px }
.swatch{ border-radius:14px; padding:14px; background:#fff; box-shadow:var(--shadow); transition:transform .2s; cursor:pointer }
.swatch:hover{ transform:scale(1.05) }
.swatch .chip{ height:56px; border-radius:12px; margin-bottom:10px }
.swatch code{ font-family:'Sora', sans-serif; font-size:13px; color:#333; }
/* Sixtyfour ONLY here for color titles */
.swatch h4{ margin:2px 0 6px; font-family:'Sixtyfour', sans-serif; font-weight:200; letter-spacing:.02em; font-variation-settings:"BLED" 0, "SCAN" 0 }

/* Fullscreen color modal */
.color-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.8);z-index:1000}
.color-modal .close-modal{position:absolute;top:20px;right:20px;background:none;border:0;color:#fff;font-size:32px;cursor:pointer}
.color-modal .usage-logo{max-width:40%;height:auto}
.color-modal .toggle-logo{position:absolute;bottom:20px;left:20px;background:rgba(0,0,0,.4);color:#fff;border:0;padding:6px 10px;border-radius:8px;cursor:pointer;font-size:14px}

/* Typography examples */
.type-row{ display:grid; grid-template-columns:1fr; gap:8px }
.sample{ padding:12px 14px; border-radius:12px; background:#fff; box-shadow:var(--shadow) }
.sample .cap{ font-size:12px; color:#666; margin-bottom:6px }
.sample .text{ font-size:28px; }

/* Typography generator */
.type-tool{margin-top:20px;}
.type-tool textarea{width:100%;min-height:80px;padding:10px;border-radius:8px;border:1px solid #ccc;font-family:'Sora',sans-serif;font-size:16px}
.type-tool .controls{display:flex;flex-wrap:wrap;gap:10px;margin:10px 0}
.type-tool canvas{display:none}
.type-tool .canvas{margin-top:10px;background:#fff;box-shadow:var(--shadow);width:100%;max-width:400px;height:400px;background-size:cover;background-position:center;border-radius:12px}

/* Social templates */
.templates{ display:grid; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); gap:14px }
.frame{ background:var(--card); border-radius:18px; padding:12px; box-shadow:var(--shadow) }
.canvas{ border-radius:12px; background:var(--neutral3); display:grid; place-items:center; overflow:hidden }
.canvas.square{ aspect-ratio:1/1 }
.canvas.portrait{ aspect-ratio:4/5 }
.canvas.landscape{ aspect-ratio:16/9 }
.canvas .ghost{ opacity:.22; font-family:'Modak', cursive; letter-spacing:.04em }
.canvas img{ max-width:80%; max-height:80%; width:auto; height:auto; object-fit:contain; }
.download{ margin-top:6px; font-size:12px; }

/* Section headings */
h3.section{ font-family:'Sora', sans-serif; font-weight:400; margin:28px 0 12px; font-size:48px; letter-spacing:.01em }
@media(max-width:700px){ h3.section{ font-size:32px } }

footer{ margin-top:30px; color:#666; font-size:12px; text-align:center }

/* Small helpers */
.mono{ font-family:'Sora', sans-serif }
.nowrap{ white-space:nowrap }
.drop{ display:inline-block; padding:8px 10px; border:1px dashed color-mix(in srgb, var(--ink) 25%, transparent); border-radius:10px; font-size:12px; color:#555 }
</style>
</head>
<body>
<div class="container">
  <header class="header">
    <div class="brand">
      <div class="dot"></div>
      <h1><span class="modak">A GRIEF LIKE MINE</span><span class="sora"> — Brand Kit</span></h1>
    </div>
    <nav>
      <a href="#overview">Overview</a>
      <a href="#logo">Logo Usage</a>
        <a href="#colors">Colors</a>
        <a href="#type">Typography</a>
        <a href="#templates">Social Templates</a>
      <a href="#photos">Photo Direction</a>
      <a href="#exports">Exports</a>
    </nav>
  </header>

  <section id="overview" class="hero card">
    <div class="particles" id="particles"></div>
    <h2>Overview</h2>
    <p>This page previews the <strong>2025</strong> brand system using only <strong>Modak</strong> and <strong>Sora</strong>. Brand colors are restored to the original blues + neutrals. The <span class="mono">Sixtyfour</span> font is used <em>only</em> for swatch titles in the Colors section.</p>
  </section>

  <section id="logo" class="grid" style="margin-top:22px">
    <div class="card" style="grid-column: span 7;">
      <h3 class="section">Main Logo — “A Grief Like Mine — 1×1 Center”</h3>
      <div class="stage" id="logoStage">
        <img id="brandLogoIMG"
             src="https://i.ibb.co/N2Lr6c4s/A-Grief-Like-Mine-1x1-center.png"p
             alt="A Grief Like Mine — 1×1 Center" />
        <a id="logoStageLink" class="fullscreen-link" href="https://i.ibb.co/N2Lr6c4s/A-Grief-Like-Mine-1x1-center.png" aria-label="Open full image"></a>
      </div>
      <div class="actions">
        <label class="drop" for="logoUpload">Upload logo (SVG / PNG / AI / PDF)</label>
        <input id="logoUpload" type="file" accept="image/svg+xml,image/png,.ai,application/pdf" style="position:absolute;opacity:0;pointer-events:none" aria-hidden="true" />
        <button id="exportPNG">Download PNG (transparent, 3000×3000)</button>
        <button class="secondary" id="toggleBG">Toggle Preview BG</button>
      </div>
      <div style="margin-top:10px; color:#555; font-size:13px">
        <strong>Clearspace:</strong> Maintain “G” height around the mark. <span class="nowrap"><strong>Min size:</strong> 32 px</span>. Avoid drop‑shadows or strokes on the logo.
      </div>
    </div>

    <div class="card" style="grid-column: span 5;">
      <h3 class="section">Logo Usage</h3>
      <ul style="margin:0 0 6px 18px">
        <li>Use the centered 1×1 mark for avatars, favicons, stickers, and profile icons.</li>
        <li>On light backgrounds, prefer the full‑color mark (blues + ink). On dark, use an all‑white version.</li>
        <li>Do not skew, warp, or add effects. Do not re‑color outside the approved palette.</li>
        <li>Maintain contrast ratio ≥ 4.5:1 when placing over photos.</li>
      </ul>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px">
        <div class="stage" style="aspect-ratio:1/1; background:#fff" id="logoLight">
          <img id="logoLightIMG" src="https://i.ibb.co/DDXtHnk4/A-Grief-Like-Mine-Top-1-transparent.png" alt="Logo on light"/>
          <a id="logoLightLink" class="fullscreen-link" href="https://i.ibb.co/DDXtHnk4/A-Grief-Like-Mine-Top-1-transparent.png" aria-label="Open full image"></a>
        </div>
        <div class="stage" style="aspect-ratio:1/1; background:#111" id="logoDark">
          <img id="logoDarkIMG" src="https://i.ibb.co/DDXtHnk4/A-Grief-Like-Mine-Top-1-transparent.png" alt="Logo on dark"/>
          <a id="logoDarkLink" class="fullscreen-link" href="https://i.ibb.co/DDXtHnk4/A-Grief-Like-Mine-Top-1-transparent.png" aria-label="Open full image"></a>
          <a id="logoDarkLink" class="fullscreen-link" href="https://i.ibb.co/mCGyLQ0D/A-Grief-Like-Mine-1x1-center-transparent.png" aria-label="Open full image"></a>
        </div>
      </div>
    </div>

    <div class="card" style="grid-column: span 12; margin-top:20px;">
      <h3 class="section">Alternative Logo — Illustration 3D</h3>
      <div class="stage" id="altLogoStage">
        <img id="altLogoIMG" src="https://i.ibb.co/gLsRFMTd/AGLM-Illustration-3-D-logo-large.png" alt="AGLM Illustration 3D logo"/>
        <a id="altLogoLink" class="fullscreen-link" href="https://i.ibb.co/gLsRFMTd/AGLM-Illustration-3-D-logo-large.png" aria-label="Open full image"></a>
      </div>
    </div>
  </section>

  <section id="colors" class="card" style="margin-top:22px">
    <h3 class="section">Color Guide</h3>
    <div class="swatches">
      <div class="swatch"><div class="chip" style="background:var(--blue1)"></div><h4>Primary Blue</h4><code>#2C6FB1</code></div>
      <div class="swatch"><div class="chip" style="background:var(--blue2)"></div><h4>Sky</h4><code>#6FB1FF</code></div>
      <div class="swatch"><div class="chip" style="background:var(--blue3)"></div><h4>Deep Blue</h4><code>#1D3F73</code></div>
      <div class="swatch"><div class="chip" style="background:var(--sunset)"></div><h4>Sunset Orange</h4><code>#DE9146</code></div>
      <div class="swatch"><div class="chip" style="background:var(--ink)"></div><h4>Ink</h4><code>#111111</code></div>
      <div class="swatch"><div class="chip" style="background:var(--blueA)"></div><h4>Blue A</h4><code>#294B81</code></div>
      <div class="swatch"><div class="chip" style="background:var(--blueB)"></div><h4>Blue B</h4><code>#6B89BD</code></div>
      <div class="swatch"><div class="chip" style="background:var(--blueC)"></div><h4>Blue C</h4><code>#335694</code></div>
      <div class="swatch"><div class="chip" style="background:var(--neutral3)"></div><h4>Porcelain</h4><code>#F3F0EC</code></div>
      <div class="swatch"><div class="chip" style="background:var(--neutral2)"></div><h4>Bone</h4><code>#EBE9D5</code></div>
      <div class="swatch"><div class="chip" style="background:var(--neutral1)"></div><h4>Oat</h4><code>#EFE5D7</code></div>
      <div class="swatch"><div class="chip" style="background:var(--rose)"></div><h4>Rose Accent</h4><code>#DBB5C2</code></div>
    </div>
    <p style="margin-top:10px; color:#555; font-size:13px">All UI and illustrations should reference these CSS tokens. Neutrals for surfaces; blues for hero/accents; rose sparingly.</p>
  </section>

    <section id="type" class="card" style="margin-top:22px">
      <h3 class="section">Typography</h3>
    <div class="type-row">
      <div class="sample">
        <div class="cap">Display — Modak</div>
        <div class="text" style="font-family:'Modak', cursive;">A Grief Like Mine</div>
      </div>
      <div class="sample">
        <div class="cap">Body & UI — Sora</div>
        <div class="text" style="font-family:'Sora', sans-serif; font-weight:500;">The sea remembers. We move gently, not swiftly.</div>
      </div>
    </div>

    <div class="type-tool">
      <textarea id="typeInput" placeholder="Write a quote..."></textarea>
      <div class="controls">
        <label>Font
          <select id="fontSelect">
            <option value="Sora">Sora</option>
            <option value="Modak">Modak</option>
          </select>
        </label>
        <label>Logo position
          <select id="logoPos">
            <option value="none">None</option>
            <option value="bottom-right">Bottom Right</option>
            <option value="bottom-left">Bottom Left</option>
            <option value="top-right">Top Right</option>
            <option value="top-left">Top Left</option>
            <option value="top-center">Top Center</option>
            <option value="bottom-center">Bottom Center</option>
          </select>
        </label>
        <button id="downloadPNG" class="btn secondary">Download PNG</button>
      </div>
      <canvas id="typeCanvas" width="3000" height="3000"></canvas>
      <div id="typePreview" class="canvas square"><div class="ghost">Preview</div></div>
    </div>
  </section>

  <section id="kinetic" class="card" style="margin-top:22px">
    <h3 class="section">Kinetic Typography</h3>
    <div class="stage">
      <img src="https://i.ibb.co/rGKS5vTC/A-GRIEF-LIKE-MINE-Kinetic-Typography-transparent-Recovered.png" alt="Kinetic Typography" style="width:80%;height:auto"/>
      <a class="fullscreen-link" href="https://i.ibb.co/rGKS5vTC/A-GRIEF-LIKE-MINE-Kinetic-Typography-transparent-Recovered.png" aria-label="Open full image"></a>
    </div>
  </section>

  <section id="templates" class="card" style="margin-top:22px">
    <h3 class="section">Social Templates</h3>
    <button id="cycleLogo" class="btn secondary" style="margin-bottom:14px">Next Logo</button>
    <div class="templates">
      <div class="frame">
        <div class="canvas square"><img class="template-img" alt="Logo"><div class="ghost">1×1</div></div>
        <button class="download" data-size="square">Download 1×1</button>
        <div style="font-size:12px; margin-top:6px; color:#555">Profile / Grid</div>
      </div>
      <div class="frame">
        <div class="canvas portrait"><img class="template-img" alt="Logo"><div class="ghost">4×5</div></div>
        <button class="download" data-size="portrait">Download 4×5</button>
        <div style="font-size:12px; margin-top:6px; color:#555">IG Portrait</div>
      </div>
      <div class="frame">
        <div class="canvas landscape"><img class="template-img" alt="Logo"><div class="ghost">16×9</div></div>
        <button class="download" data-size="landscape">Download 16×9</button>
        <div style="font-size:12px; margin-top:6px; color:#555">Video / YouTube</div>
      </div>
    </div>
  </section>

  <section id="photos" class="card" style="margin-top:22px">
    <h3 class="section">Photo Direction</h3>
    <ul style="margin:0 0 0 18px">
      <li>Cool light, north‑facing or overcast. Avoid direct midday sun.</li>
      <li>Textures: paper, linen, water, matte ceramics. Minimal gloss.</li>
      <li>Palette: blues + bone neutrals; occasional rose accent.</li>
      <li>Negative space for type; keep horizon lines calm.</li>
    </ul>
  </section>

  <section id="exports" class="card" style="margin-top:22px">
    <h3 class="section">Exports</h3>
    <p>Upload your approved logo (SVG or PNG) and click <strong>Download PNG</strong> to export a high‑res transparent PNG of the centered logo (3000×3000). If you only have an <strong>.ai</strong> file, export it to <em>SVG</em> or <em>PNG</em> first, then upload here.</p>
    <div style="font-size:12px; color:#666">Note: Export uses client‑side canvas for transparency and crisp edges.</div>
  </section>

  <footer>© 2025 A GRIEF LIKE MINE — Brand system preview</footer>
</div>

<!-- Hidden symbol rigs for the idle-only bird & butterfly -->
<svg width="0" height="0" aria-hidden="true" focusable="false">
  <symbol id="BIRD_RIG" viewBox="0 0 100 80">
    <path fill="var(--blue1)" d="M53,44c8,0,17-8,17-16c0-9-9-16-20-16c-10,0-18,6-21,13c-8,2-15,9-15,16c0,7,6,12,15,12c9,0,17-4,24-9z"/>
    <path fill="var(--blue3)" d="M35,45l-18,16l10-3l-7,12l17-17z"/>
    <path fill="var(--blue2)" d="M70,26l14-4l-10,10z"/>
    <circle cx="61" cy="23" r="2.1" fill="#0b1d36"/>
    <g class="wing" style="transform-origin:40px 33px; --arc:10deg">
      <path fill="var(--blue2)" d="M18,20c8,3,18,8,24,14c-8,0-17-1-26-3c-6-2-6-9,2-11z"/>
    </g>
    <g class="wing" style="transform-origin:62px 38px; --arc:10deg">
      <path fill="var(--blue2)" d="M42,30c10,2,21,7,28,13c-8,1-17,0-27-2c-6-2-6-9-1-11z"/>
    </g>
  </symbol>
  <symbol id="BUTTER_RIG" viewBox="0 0 100 80">
    <rect x="48" y="30" width="4" height="22" rx="2" fill="var(--blue3)"/>
    <circle cx="50" cy="28" r="5" fill="var(--blue3)"/>
    <g class="wing" style="transform-origin:52px 40px; --arc:16deg">
      <path fill="var(--blue1)" d="M50,40 C25,15 10,35 15,47 C20,60 35,58 48,46 Z"/>
      <circle cx="37" cy="45" r="4" fill="var(--blue2)"/>
    </g>
    <g class="wing" style="transform-origin:48px 40px; --arc:-16deg">
      <path fill="var(--blue1)" d="M50,40 C75,15 90,35 85,47 C80,60 65,58 52,46 Z"/>
      <circle cx="63" cy="45" r="4" fill="var(--blue2)"/>
    </g>
  </symbol>
</svg>

<div id="colorModal" class="color-modal" aria-hidden="true">
  <button class="close-modal" aria-label="Close">&times;</button>
  <button class="toggle-logo" aria-label="Toggle logo">Logo</button>
  <img id="usageLogo" class="usage-logo" alt="Usage logo" src="https://i.ibb.co/DDXtHnk4/A-Grief-Like-Mine-Top-1-transparent.png">
</div>

<div id="logoModal" class="color-modal" aria-hidden="true">
  <button class="close-modal" aria-label="Close">↙</button>
  <img id="logoModalImg" class="usage-logo" alt="Full logo">
</div>

<script>
// Color swatch modal
(function(){
  const modal=document.getElementById('colorModal');
  const close=modal.querySelector('.close-modal');
  const toggle=modal.querySelector('.toggle-logo');
  const logo=modal.querySelector('#usageLogo');
  const logos=[
    'https://i.ibb.co/DDXtHnk4/A-Grief-Like-Mine-Top-1-transparent.png',
    'https://i.ibb.co/rGKS5vTC/A-GRIEF-LIKE-MINE-Kinetic-Typography-transparent-Recovered.png',
    null
  ];
  let logoIndex=0;
  function updateLogo(){
    const src=logos[logoIndex];
    if(src){
      logo.src=src;
      logo.style.display='block';
    }else{
      logo.style.display='none';
    }
  }
  updateLogo();

  toggle.addEventListener('click',()=>{
    logoIndex=(logoIndex+1)%logos.length;
    updateLogo();
  });

  document.querySelectorAll('.swatch').forEach(sw=>{
    sw.addEventListener('click',()=>{
      const color=getComputedStyle(sw.querySelector('.chip')).backgroundColor;
      modal.style.background=color;
      modal.style.display='flex';
    });
  });
  function hide(){
    modal.style.display='none';
    logoIndex=0;
    updateLogo();
  }
  close.addEventListener('click',hide);
  modal.addEventListener('click',e=>{if(e.target===modal)hide();});
  document.addEventListener('keydown',e=>{if(e.key==='Escape')hide();});
})();

// Logo fullscreen modal
(function(){
  const modal=document.getElementById('logoModal');
  const img=modal.querySelector('#logoModalImg');
  const close=modal.querySelector('.close-modal');
  function hide(){modal.style.display='none';img.src='';}
  document.querySelectorAll('.fullscreen-link').forEach(link=>{
    link.addEventListener('click',e=>{
      e.preventDefault();
      img.src=link.href;
      modal.style.display='flex';
    });
  });
  close.addEventListener('click',hide);
  modal.addEventListener('click',e=>{if(e.target===modal)hide();});
  document.addEventListener('keydown',e=>{if(e.key==='Escape')hide();});
})();

// Idle-only floating sprites in the hero
(function(){
  const particles = document.getElementById('particles');
  const R = (a,b)=> a + Math.random()*(b-a);

  function spawn(kind, x, y){
    const el = document.createElement('div');
    el.className = 'sprite ' + kind;
    const sv = document.createElementNS('http://www.w3.org/2000/svg','svg');
    sv.setAttribute('viewBox','0 0 100 80');
    const use = document.createElementNS('http://www.w3.org/2000/svg','use');
    use.setAttributeNS('http://www.w3.org/1999/xlink','href', kind==='bird'?'#BIRD_RIG':'#BUTTER_RIG');
    sv.appendChild(use); el.appendChild(sv);
    particles.appendChild(el);

    const w = particles.getBoundingClientRect().width;
    const h = particles.getBoundingClientRect().height;
    const px = (x ?? R(w*0.1, w*0.9));
    const py = (y ?? R(h*0.2, h*0.8));

    el.style.left = (px - 22) + 'px';
    el.style.top  = (py - 20) + 'px';
    el.style.setProperty('--dur', Math.round(R(5200, 8200)) + 'ms');
    el.style.setProperty('--flap', Math.round(R(900, 1400)) + 'ms');
    el.style.setProperty('--arc', R(10,16) + 'deg');
    el.style.setProperty('--start', R(-2,2) + 'deg');
    el.style.setProperty('--end', R(-4,2) + 'deg');
  }

  // a couple floating friends
  spawn('bird'); spawn('butter');
  setTimeout(()=> spawn('butter'), 600);
})();

// Global flock following cursor
(function(){
  const layer=document.createElement('div');
  layer.className='flock-layer';
  document.body.appendChild(layer);
  const rand=(a,b)=>a+Math.random()*(b-a);
  const kinds=['BIRD_RIG','BUTTER_RIG'];
  function make(x,y,kind){
    const el=document.createElement('div');
    el.className='flock';
    el.style.setProperty('--x',x+'px');
    el.style.setProperty('--y',y+'px');
    el.style.setProperty('--dx',rand(-180,180)+'px');
    el.style.setProperty('--dy',rand(-260,-120)+'px');
    el.style.setProperty('--r0',rand(-22,22)+'deg');
    el.style.setProperty('--r1',rand(-28,8)+'deg');
    el.style.setProperty('--s',rand(0.8,1.2));
    el.style.setProperty('--dur',rand(2200,3400)+'ms');
    el.style.setProperty('--flap',rand(420,980)+'ms');
    el.innerHTML=`<svg viewBox="0 0 100 80" width="100%" height="100%"><use href="#${kind}"/></svg>`;
    layer.appendChild(el);
    requestAnimationFrame(()=>el.classList.add('fly'));
    el.addEventListener('animationend',()=>el.remove(),{once:true});
  }
  function flock(x,y,count=14){ for(let i=0;i<count;i++) make(x,y,kinds[Math.floor(Math.random()*kinds.length)]); }
  let last=0;
  document.addEventListener('mousemove',e=>{const now=Date.now(); if(now-last>200){last=now; make(e.clientX,e.clientY,kinds[Math.floor(Math.random()*kinds.length)]);} });
  document.addEventListener('click',e=>flock(e.clientX,e.clientY,16));
})();

// Logo upload & previews
(function(){
  const input = document.getElementById('logoUpload');
  const stage = document.getElementById('logoStage');
  const light = document.getElementById('logoLight');
  const dark  = document.getElementById('logoDark');
  const mainLink = document.getElementById('logoStageLink');

  document.querySelector('label[for="logoUpload"]').addEventListener('click',()=> input.click());

  function clear(node){ while(node && node.firstChild) node.removeChild(node.firstChild); }
  function renderPreview(target, dataURL){
    if(!target) return;
    let img = target.querySelector('img');
    if(!img){
      img = document.createElement('img');
      img.style.width='80%'; img.style.height='auto';
      target.appendChild(img);
    }
    img.src = dataURL;
    let link = target.querySelector('.fullscreen-link');
    if(!link){
      link = document.createElement('a');
      link.className='fullscreen-link';
      link.removeAttribute('target');
      link.setAttribute('aria-label','Open full image');
      target.appendChild(link);
    }
    link.href = dataURL;
  }

  input.addEventListener('change', async (e)=>{
    const file = e.target.files?.[0];
    if(!file) return;
    const ext = (file.name.split('.').pop()||'').toLowerCase();
    if(ext==='ai' || file.type==='application/pdf'){
      const note = document.createElement('div');
      note.style.cssText = 'position:absolute;bottom:10px;left:10px;background:rgba(255,255,255,.9);padding:8px 10px;border-radius:10px;font-size:12px;color:#333;box-shadow:0 4px 14px rgba(0,0,0,.08)';
      note.textContent = 'AI/PDF cannot preview in-browser. In Illustrator: File → Export As → SVG (or PNG), then upload here.';
      stage.appendChild(note);
      return;
    }

    const reader = new FileReader();
    reader.onload = ()=>{
      const url = reader.result;
      const imgEl = stage.querySelector('#brandLogoIMG');
      if(imgEl){ imgEl.src = url; }
      else{
        const holder = document.createElement('img');
        holder.id = 'brandLogoIMG'; holder.alt = 'Uploaded logo';
        holder.src = url; holder.style.width='80%'; holder.style.height='auto';
        stage.appendChild(holder);
      }
      if(mainLink) mainLink.href = url;
      renderPreview(light, url);
      renderPreview(dark, url);
    };
    reader.readAsDataURL(file);
  });
})();

// Export PNG (transparent) for the centered logo (uploaded or inline)
(function(){
  const btn = document.getElementById('exportPNG');
  const toggle = document.getElementById('toggleBG');
  const stage = document.getElementById('logoStage');

  function exportPNG(){
    const size = 3000; // 3000x3000px
    const canvas = document.createElement('canvas');
    canvas.width = size; canvas.height = size;
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0,0,size,size);

    const nodeImg = stage.querySelector('#brandLogoIMG');

    function drawAndSave(img){
      const scale = 0.8; // match visual scale
      const s = size * scale;
      const x = (size - s)/2; const y = (size - s)/2;
      ctx.drawImage(img, x, y, s, s);
      canvas.toBlob((blob)=>{
        const a = document.createElement('a');
        a.download = 'AGLM_Logo_1x1_center_3000.png';
        a.href = URL.createObjectURL(blob);
        a.click(); URL.revokeObjectURL(a.href);
      }, 'image/png');
    }

    if(nodeImg){
      const img = new Image();
      img.crossOrigin = 'anonymous';
      img.onload = ()=> drawAndSave(img);
      img.src = nodeImg.src;
    }
  }

  function toggleBG(){
    const current = getComputedStyle(stage).backgroundColor;
    stage.style.background = (current === 'rgba(0, 0, 0, 0)' || current === 'transparent') ? 'var(--neutral3)' : 'transparent';
  }

  btn?.addEventListener('click', exportPNG);
  toggle?.addEventListener('click', toggleBG);
})();

// Typography generator
(function(){
  const input=document.getElementById('typeInput');
  const fontSel=document.getElementById('fontSelect');
  const posSel=document.getElementById('logoPos');
  const canvas=document.getElementById('typeCanvas');
  const ctx=canvas.getContext('2d');
  const preview=document.getElementById('typePreview');
  const btn=document.getElementById('downloadPNG');
  const logo=new Image();
  logo.crossOrigin='anonymous';
  logo.src='https://i.ibb.co/N2Lr6c4s/A-Grief-Like-Mine-1x1-center.png';

  function render(){
    ctx.clearRect(0,0,3000,3000);
    ctx.fillStyle='#f3f0ec';
    ctx.fillRect(0,0,3000,3000);
    ctx.fillStyle='#111';
    ctx.textAlign='center';
    ctx.textBaseline='middle';
    ctx.font='120px '+fontSel.value;
    const lines=input.value.split('\n');
    const lh=150;
    lines.forEach((line,i)=>ctx.fillText(line,1500,1400 + i*lh));
    const pos=posSel.value;
    const size=300;
    const map={
      'bottom-right':[3000-size-50,3000-size-50],
      'bottom-left':[50,3000-size-50],
      'top-right':[3000-size-50,50],
      'top-left':[50,50],
      'top-center':[(3000-size)/2,50],
      'bottom-center':[(3000-size)/2,3000-size-50]
    };
    if(map[pos]) ctx.drawImage(logo,map[pos][0],map[pos][1],size,size);
    const url=canvas.toDataURL('image/png');
    preview.style.backgroundImage=`url(${url})`;
    preview.style.backgroundSize='cover';
    return url;
  }
  [input,fontSel,posSel].forEach(el=>el?.addEventListener('input',render));
  btn?.addEventListener('click',()=>{const url=render();const a=document.createElement('a');a.href=url;a.download='typography.png';a.click();});
  render();
})();

// Social template logo cycling & downloads
(function(){
  const logos=['assets/logo-top-1.svg','assets/logo-top-2.svg','assets/logo-top-3.svg'];
  let idx=0;
  const imgs=document.querySelectorAll('.template-img');
  const ghosts=document.querySelectorAll('.canvas .ghost');
  function render(){
    imgs.forEach(img=>{ img.src=logos[idx]; });
    ghosts.forEach(g=> g.style.display='none');
  }
  document.getElementById('cycleLogo')?.addEventListener('click',()=>{ idx=(idx+1)%logos.length; render(); });
  render();

  function download(type){
    const map={square:[1080,1080],portrait:[1080,1350],landscape:[1920,1080]};
    const [w,h]=map[type];
    const canvas=document.createElement('canvas');
    canvas.width=w; canvas.height=h;
    const ctx=canvas.getContext('2d');
    const img=new Image();
    img.crossOrigin='anonymous';
    img.onload=()=>{
      const scale=Math.min((w*0.8)/img.width,(h*0.8)/img.height);
      const dw=img.width*scale; const dh=img.height*scale;
      ctx.drawImage(img,(w-dw)/2,(h-dh)/2,dw,dh);
      canvas.toBlob(b=>{const a=document.createElement('a');a.download=`AGLM_${type}.png`;a.href=URL.createObjectURL(b);a.click();URL.revokeObjectURL(a.href);});
    };
    img.src=logos[idx];
  }
  document.querySelectorAll('.download').forEach(btn=>btn.addEventListener('click',()=>download(btn.dataset.size)));
})();
</script>
</body>
</html>
